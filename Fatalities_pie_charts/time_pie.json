{
    "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
    "width": 400,
    "height": 400,
    "projection": {
        "type": "azimuthalEquidistant",
        "rotate": {
            "expr": "[0,90,180]"
        }
    },
    "layer": [
        {
            "data": {
                "graticule": {
                    "step": [
                        15,
                        7.5
                    ],
                    "extent": [
                        [
                            -180,
                            -59.999
                        ],
                        [
                            180,
                            -90
                        ]
                    ]
                }
            },
            "mark": {
                "type": "geoshape",
                "color": "black",
                "filled": false,
                "strokeWidth": 0.2
            }
        },
        {
            "data": {
                "url": "https://raw.githubusercontent.com/mzMarkZheng/FIT3179_Week_10_HW/main/Dataset/Time_fat_piechart/time_fatalities.csv"
            },
            "transform": [
                {
                    "aggregate": [
                        {
                            "op": "sum",
                            "field": "num_fatalities_time",
                            "as": "sum_fatalities_time"
                        }
                    ],
                    "groupby": [
                        "theta"
                    ]
                },
                {
                    "joinaggregate": [
                        {
                            "op": "max",
                            "field": "sum_fatalities_time",
                            "as": "sum_fatalities_time_max"
                        },
                        {
                            "op": "min",
                            "field": "sum_fatalities_time",
                            "as": "sum_fatalities_time_min"
                        }
                    ]
                },
                {
                    "calculate": "-1 * (((datum.sum_fatalities_time - datum.sum_fatalities_time_min) * 25)/(datum.sum_fatalities_time_max - datum.sum_fatalities_time_min) + 60)",
                    "as": "sum_fatalities_time"
                }
            ],
            "encoding": {
                "longitude": {
                    "field": "theta"
                },
                "latitude": {
                    "field": "sum_fatalities_time"
                },
                "tooltip": [
                    {
                        "field": "sum_fatalities_time",
                        "type": "quantitative"
                    }
                ]
            },
            "mark": {
                "type": "line",
                "strokeWidth": 4
            }
        },
        {
            "data": {
                "values": [
                    {
                        "theta": -180,
                        "r": -55,
                        "label": "12 AM"
                    },
                    {
                        "theta": -165,
                        "r": -55,
                        "label": "1 AM"
                    },
                    {
                        "theta": -150,
                        "r": -55,
                        "label": "2 AM"
                    },
                    {
                        "theta": -135,
                        "r": -55,
                        "label": "3 AM"
                    },
                    {
                        "theta": -120,
                        "r": -55,
                        "label": "4 AM"
                    },
                    {
                        "theta": -105,
                        "r": -55,
                        "label": "5 AM"
                    },
                    {
                        "theta": -90,
                        "r": -55,
                        "label": "6 AM"
                    },
                    {
                        "theta": -75,
                        "r": -55,
                        "label": "7 AM"
                    },
                    {
                        "theta": -60,
                        "r": -55,
                        "label": "8 AM"
                    },
                    {
                        "theta": -45,
                        "r": -55,
                        "label": "9 AM"
                    },
                    {
                        "theta": -30,
                        "r": -55,
                        "label": "10 AM"
                    },
                    {
                        "theta": -15,
                        "r": -55,
                        "label": "11 AM"
                    },
                    {
                        "theta": 0,
                        "r": -55,
                        "label": "12 PM"
                    },
                    {
                        "theta": 15,
                        "r": -55,
                        "label": "1 PM"
                    },
                    {
                        "theta": 30,
                        "r": -55,
                        "label": "2 PM"
                    },
                    {
                        "theta": 45,
                        "r": -55,
                        "label": "3 PM"
                    },
                    {
                        "theta": 60,
                        "r": -55,
                        "label": "4 PM"
                    },
                    {
                        "theta": 75,
                        "r": -55,
                        "label": "5 PM"
                    },
                    {
                        "theta": 90,
                        "r": -55,
                        "label": "6 PM"
                    },
                    {
                        "theta": 105,
                        "r": -55,
                        "label": "7 PM"
                    },
                    {
                        "theta": 120,
                        "r": -55,
                        "label": "8 PM"
                    },
                    {
                        "theta": 135,
                        "r": -55,
                        "label": "9 PM"
                    },
                    {
                        "theta": 150,
                        "r": -55,
                        "label": "10 PM"
                    },
                    {
                        "theta": 165,
                        "r": -55,
                        "label": "11 PM"
                    }
                ]
            },
            "encoding": {
                "longitude": {
                    "field": "theta"
                },
                "latitude": {
                    "field": "r"
                },
                "text": {
                    "field": "label"
                }
            },
            "mark": "text"
        }
    ]
}